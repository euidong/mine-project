name: React build
on: 
  push:
    branches:
      - master

jobs:
    build:
        name: react build
        runs-on: ubuntu-18.04
        steps:
            - name: Checkout source code
              uses: actions/checkout@master

            - name: Cache node modules
              uses: actions/cache@v1
              with:
                path: node_modules
                key: ${{ runner.OS }}-build-${{ hashFiles('**/package-lock.json') }}
                restor-keys: |
                  ${{ runner.OS }}-build-
                  ${{ runner.OS }}-

            - name: Install Dependencies
              run: npm install

            - name: Build
              run: npm run build
              
            - name: Deploy
              uses: JamesIves/github-pages-deploy-action@releases/v3
              with:
                ACCESS_TOKEN: ${{ secrets.ACCESS_TOKEN }}
                BRANCH: gh-pages # The branch the action should deploy to.
                FOLDER: build 